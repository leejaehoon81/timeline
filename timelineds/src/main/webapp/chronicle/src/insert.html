<html>
<head>
<meta charset='UTF-8'>
<link rel="stylesheet" type="text/css" href="css/bootstrap.min.css" />
<link rel="stylesheet" type="text/css" href="css/bootstrap-datepicker.css" />

<link rel="stylesheet" href="../../fileUpload/css/styles.css">
<link rel="stylesheet" href="../../fileUpload/css/main.css">
    
<script type="text/javascript" src="js/libs/jquery.min.js"></script>
<script type="text/javascript" src="js/libs/bootstrap.min.js"></script>
<script type="text/javascript" src="js/libs/bootstrap-datepicker.js"></script>
<script type="text/javascript" src="js/libs/bootstrap-datepicker.kr.min.js"></script>

<style>
 html {
	overflow: hidden;
}
</style>
</head>
<body>
<div id='formDiv'>
	<form class="form-horizontal">

		<div class="form-group">
			<label for="fTitle" class="col-sm-2 control-label">제목</label>
			<div class="col-sm-10">
				<input type="text" class="form-control" id="fTitle" placeholder="최대 100글자 입니다">
			</div>
		</div>
		<div class="form-group">
			<label for="fContent" class="col-sm-2 control-label">내용</label>
			<div class="col-sm-10">
				<textarea id='fContent' rows='5' class="form-control" placeholder="내용을 써주세요"></textarea>
			</div>
		</div>
		
		<b>날짜를 선택하세요</b>
		<div class="input-group date">
      <input type="text" class="form-control" id="myCal">
        <span class="input-group-addon">
          <i class="glyphicon glyphicon-th"></i>
        </span>
    </div>




		<!-- fileupload -->





      <div id="btnArea">
				<button id='insertBtn' type='button' class="btn btn-success btn-sm my-new">등록</button>
				<button id='cancelBtn' type='reset' class="btn btn-info btn-sm">취소</button>
			</div>
	</form>
</div>

<script>

  $('#test').on('click', function(e) {
    e.preventDefault();
    
  });

	$('.input-group.date').datepicker({
	  format: "yyyy/mm/dd",
	  language: "kr",
	  autoclose: true,
	  todayHighlight: true
	});

  (function($) {
    $.chronicle = {
      insert : function() {
    	  
         // console.log($('#content', parent.parent.document));
          //$('#content', parent.parent.document.onload);
       
        $.ajax('insert.do', {
          method : 'POST',
          dataType : 'json',
          data : {
            mainNo : 1,
            Title : $('#fTitle').val(),
            Body : $('#fContent').val(),
            JulianDayStart : myDate($('#myCal').val()),
            StartDisplay : myDisplay($('#myCal').val()),
            StartDisplayYear : myDisplay($('#myCal').val()),
            /* ThumbnailPath : {{file.name}}, */
            priority : 1
          },
          success : function(result) {
            if (result.Events == 'success') {
            	window.parent.parent.location.reload();
            } else {
              alert('입력실패');
            }
          }
        });
      }
    };
  })(jQuery);

  $('#insertBtn').click(function(e) {
    e.preventDefault();
    $.chronicle.insert();
  });
  
  
  
  
var myDate = function(calendar) {
  
    var julianday;
    
    if(calendar == ""){
      alert('날짜를 올바르게 입력하세요');
      julianday = '문자';
      return julianday;
    } else {
      var year = calendar.substring(0,4);
      var month = calendar.substring(5,7);
      var day = calendar.substring(8,10);
      
      year = Number(year);
      month = Number(month);
      day = Number(day);
      
      if (month < 3) {
        year--;
        month += 12;
      }

      if (true) {
        var A = Math.floor(year / 100);
        var B = Math.floor(A / 4);
        var C = 2 - A + B;
      } else 
        C = 0;
      
      var E = Math.floor(365.25 * (year + 4716));
      var F = Math.floor(30.6001 * (month + 1));
      
      julianday = C + day + E + F - 1524; // 1524.5
      console.log(julianday);
      
      return julianday;
    }
  }
  
  var myDisplay = function(calendar) {
    var year = calendar.substring(0,4);
    var month = calendar.substring(5,7);
    var day = calendar.substring(8,10);
    
    return year + "년" + month + "월" + day + "일";
  }
  
  
</script>
</body>







